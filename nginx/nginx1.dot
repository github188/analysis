digraph nginx {
    node [
        shape = "record",
    ];

    rankdir = LR;

    // ngx_cached_time
    n_ngx_cached_time [label = "ngx_time_t : *ngx_cached_time"];

    // cached_time[64]
    subgraph cluster_cached_time_array {
        label = "ngx_time_t : cached_time[64]";
        
        n_cached_time_array [label = "<0>cached_time[0] | \
                                      <f>... | \
                                      <slot>cached_time[slot] | \
                                      <b>... | \
                                      <63>cached_time[63]"];
        n_cached_time_ngx_time_t [label = "<sec>time_t : sec | \
                                           <msec>ngx_uint_t : msec | \
                                           <gmtoff>ngx_int_t : gmtoff"];

        n_cached_time_array:slot -> n_cached_time_ngx_time_t:sec [
            style = "dotted",
        ];
        n_cached_time_array:slot -> n_cached_time_ngx_time_t:gmtoff [
            style = "dotted",
        ];
    };

    // ngx_log_file
    subgraph cluster_ngx_log_file {
        label = "ngx_open_file_t : ngx_log_file";

        n_ngx_log_file [label = "<fd>ngx_fd_t : fd | \
                                 <name>ngx_str_t : name | \
                                 <buffer>u_char : *buffer | \
                                 <pos>u_char : *pos | \
                                 <last>u_char : *last"];
    };

    // ngx_log
    subgraph cluster_ngx_log {
        label = "ngx_lot_t : ngx_log";

        n_ngx_log [label = "<log_level>ngx_uint_t : log_level | \
                            <file>ngx_open_file_t : *file | \
                            <connection>ngx_atomic_uint_t : connection | \
                            <handler>ngx_log_handler_pt : handler | \
                            <data>void : *data | \
                            <action>char : *action"];
    };

    // ngx_cycle
    n_ngx_cycle [label = "ngx_cyle_t : *ngx_cycle"];

    // init_cycle
    subgraph cluster_init_cycle {
        label = "ngx_cycle_t : init_cycle";

        n_init_cycle [label = "<conf_ctx>void : ****conf_ctx | \
                               <pool>ngx_pool_t : *pool | \
                               <log>ngx_log_t : *log | \
                               <new_log>ngx_log_t : new_log | \
                               ... | \
                               <hostname>ngx_str_t : hostname"];
    };

    // anonymity_cyle
    n_anonymity_cycle [label = "<conf_ctx>void : ****conf_ctx | \
                                <pool>ngx_pool_t : *pool | \
                                <log>ngx_log_t : *log | \
                                <new_log>ngx_log_t : new_log | \
                                ... | \
                                <listening>ngx_array_t : listening | \
                                <pathes>ngx_array_t : pathes | \
                                <open_files>ngx_list_t : open_files | \
                                <shared_memory>ngx_list_t : shared_memory | \
                                ... | \
                                <old_cycle>ngx_cycle_t : *old_cycle | \
                                ... | \
                                <hostname>ngx_str_t : hostname"];
    n_anonymity_cycle_conf_ctx [label = "<0>void : *[0] | \
                                         <1>void : *[1] | \
                                         <2>void : *[2] | \
                                         ... | \
                                         <ngx_max_moule>void : *[ngx_max_module]"];
    n_anonymity_cycle_listening [label = "<elts>void : *elts | \
                                          <nelts>ngx_uint_t : nelts | \
                                          <size>size_t : size | \
                                          <nalloc>ngx_uint_t : nalloc | \
                                          <pool>ngx_pool_t : *pool"];
    n_anonymity_cycle_listening_array [label = "<0>ngx_listening_t | \
                                                <1>ngx_listening_t | \
                                                <1>ngx_listening_t | \
                                                ... | \
                                                <nalloc>ngx_listening_t"];
    n_anonymity_cycle_listening_array_elmt [label = "<fd>ngx_socket_t : fd | \
                                                     <sockaddr>struct sockaddr : \
                                                         sockaddr | \
                                                     <socklen>socklen_t : socklen | \
                                                     <end>..."];
    n_anonymity_cycle_pathes [label = "<elts>void : *elts | \
                                       <nelts>ngx_uint_t : nelts | \
                                       <size>size_t : size | \
                                       <nalloc>ngx_uint_t : nalloc | \
                                       <pool>ngx_pool_t : *pool"];
    n_anonymity_cycle_pathes_array [label = "<0>ngx_path_t * | \
                                             <1>ngx_path_t * | \
                                             <2>ngx_path_t * | \
                                             <3>ngx_path_t * | \
                                             ... | \
                                             <nalloc>ngx_path_t *"];
    n_anonymity_cycle:listening -> n_anonymity_cycle_listening:elts [
        style = "dotted",
    ];
    n_anonymity_cycle:listening -> n_anonymity_cycle_listening:pool [
        style = "dotted",
    ];
    n_anonymity_cycle:pathes -> n_anonymity_cycle_pathes:elts [
        style = "dotted",
    ];
    n_anonymity_cycle:pathes -> n_anonymity_cycle_pathes:pool [
        style = "dotted",
    ];
    n_anonymity_cycle_listening_array:0
        -> n_anonymity_cycle_listening_array_elmt:fd [style = "dotted"];
    n_anonymity_cycle_listening_array:0
        -> n_anonymity_cycle_listening_array_elmt:end [style = "dotted"];

    // ngx_modules
    subgraph cluster_ngx_modules {
        label = "ngx_module_t : *ngx_modules[]";

        n_ngx_modules [label = "<0>ngx_module_t : *[0] | \
                                <1>ngx_module_t : *[1] | \
                                <2>ngx_module_t : *[2] | \
                                <3>ngx_module_t : *[3] | \
                                ... | \
                                <ngx_max_module>ngx_module_t : \
                                    *[ngx_max_module]"];
    };

    subgraph cluster_ngx_core_module {
        label = "ngx_module_t : ngx_core_module";

        subgraph cluster_ngx_core_conf_t {
            label = "ngx_core_conf_t";

            n_ngx_core_conf [label = "<daemon>ngx_flag_t : daemon | \
                                      <master>ngx_flag_t : master | \
                                      <end>..."];
        };
        subgraph cluster_ngx_core_module_ctx {
            label = "ngx_core_module_t : ngx_core_module_ctx";

            n_ngx_core_module_ctx [label = "<name>ngx_str_t : name | \
                                            <create_conf>void *(*create_conf) | \
                                                (ngx_cycle_t *) | \
                                            <init_conf>char *(*init_conf) | \
                                                (ngx_cycle_t *, void *)"];
        };
        n_ngx_core_module [label = "<ctx_index>ngx_uint_t : ctx_index | \
                                    ... | \
                                    <ctx>void : *ctx | \
                                    ..."];

        n_ngx_core_module:ctx -> n_ngx_core_module_ctx:name;
    };

    // conf
    subgraph cluster_conf {
        label = "ngx_conf_t : conf";

        n_conf [label = "<name>char : *name | \
                         <args>ngx_array_t : *args | \
                         <cycle>ngx_cycle_t : *cycle | \
                         <pool>ngx_pool_t : *pool | \
                         <temp_pool>ngx_pool_t : *temp_pool | \
                         <conf_file>ngx_conf_file_t : *conf_file | \
                         <log>ngx_log_t : *log | \
                         <ctx>void : *ctx | \
                         <module_type>ngx_uint_t : module_type | \
                         <handler>ngx_conf_handler_pt : handler | \
                         <handler_conf>char : *handler_conf"];
    };
    n_conf_args [label = "<0>ngx_str_t : [0] | \
                          <1>ngx_str_t : [1] | \
                          <2>ngx_str_t : [2] | \
                          ... | \
                          <9>ngx_str_t : [9]"];

    // ********** relationship **********
    n_ngx_cached_time -> n_cached_time_array:slot;

    n_ngx_log:file -> n_ngx_log_file:fd;

    n_init_cycle:log -> n_ngx_log:log_level;
    n_ngx_cycle -> n_anonymity_cycle:conf_ctx;
    n_anonymity_cycle:conf_ctx -> n_anonymity_cycle_conf_ctx:0;
    n_anonymity_cycle_conf_ctx:0 -> n_ngx_core_conf:daemon;
    n_anonymity_cycle:log -> n_ngx_log:log_level;
    n_anonymity_cycle:old_cycle -> n_init_cycle:conf_ctx;
    n_anonymity_cycle_pathes:elts -> n_anonymity_cycle_pathes_array:0;
    n_anonymity_cycle_listening:elts -> n_anonymity_cycle_listening_array:0;

    n_ngx_modules:0 -> n_ngx_core_module:ctx_index;

    n_conf:args -> n_conf_args:0;
};
